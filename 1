import greenfoot.*;
import java.util.ArrayDeque;
import java.util.Deque;
import java.awt.Rectangle;

public class Backgro extends World
{
    private GreenfootImage[] backgrounds = new GreenfootImage[22];
    private int currentBackgroundIndex = 0;
    private YellowCircle yc = new YellowCircle(70);
    private GreenfootSound amb;
    private int z;
    private Corazon c1, c2,c3;
    private int n,banderaNivel;
    private Fed fedIn;
     public Backgro()
    {   
        super(1280, 720, 1);
        n=3;//num corazon
        banderaNivel=1;
      
        c1=new Corazon();
        c2=new Corazon();
        c3=new Corazon();
        addObject(c3, 425 , 70 ); 
        addObject(c2, 350 , 70 );
        addObject(c1, 275 , 70 );
               
        Principal principal = new Principal();
        addObject(principal, getWidth()-1000 , getHeight()-50);
        initBackgrounds();
        setBackground(backgrounds[currentBackgroundIndex]);
        addObject(yc, getWidth()/2 , getHeight()/2 );
        amb = new GreenfootSound("sounds/amb.mp3");
        amb.playLoop();
    }
      public Backgro(int n, int banderaNivel)
    {    
        super(1280, 720, 1);
        this.n=n;
        this.banderaNivel=banderaNivel;
        if(n==2){
        c1=new Corazon();
        c2=new Corazon();
        addObject(c1, 275 , 70 );
        addObject(c2, 350 , 70 );
        }else if(n==1){
            c1=new Corazon();
            addObject(c1, 275 , 70 );
        }else if(n==3){
            c1=new Corazon();
            c2=new Corazon();
            c3=new Corazon();
            addObject(c3, 425 , 70 ); 
            addObject(c2, 350 , 70 );
            addObject(c1, 275 , 70 );
        }
          
        Principal principal = new Principal();
        addObject(principal, getWidth()-1000 , getHeight()-50);
        initBackgrounds();
        setBackground(backgrounds[currentBackgroundIndex]);
        addObject(yc, getWidth()/2 , getHeight()/2 );
        amb = new GreenfootSound("sounds/amb.mp3");
        amb.play();
    }
    public void act()
    {
        checkKeyPressBck();
    }

    

    public void checkKeyPressBck()
    {
        if (Greenfoot.isKeyDown("w"))
        {
            Greenfoot.delay(5);
            currentBackgroundIndex = (currentBackgroundIndex + 1) % backgrounds.length;
            setBackground(backgrounds[currentBackgroundIndex]);
            clearPreviousBackground();
            z++;
            if(z>19){
                fedIn = new Fed();
                addObject(fedIn ,getWidth()/2 , getHeight()/2);
                fedIn.fedOutAnim();
                amb.stop();
                Greenfoot.setWorld(new BlackWorld(n,banderaNivel));
            }
        }
    }

    public void initBackgrounds() {
    int index = 1;
    for (int i = 0; i < 21; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "back" + formattedIndex + ".jpg";
        backgrounds[i] = new GreenfootImage(filename);
        index += 15;  // Increment the index by 2
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + backgrounds.length) % backgrounds.length;
        backgrounds[previousIndex].clear();
    }
}
import greenfoot.*;
import java.util.ArrayDeque;
import java.util.Deque;
import java.awt.Rectangle;
import java.util.ArrayList;
import java.util.List;
public class BlackWorld extends World
{
    //private Principal principal = new Principal();
    private int n,banderaNivel;
    private Timer timer = new Timer();
    private Label label = new Label();
    private Phantom phantom;
    private YellowCircle yc = new YellowCircle(70);
    private List<Integer> numbers = new ArrayList<>();
    private GreenfootSound jumpscare;
    Corazon c1,c2,c3;
    private Door door1;
    private Door door2;
    private Door door3;
    private int numR1, numR2, numR3;
    private Fed fedIn;
    private boolean time = false;
    public BlackWorld(int n, int banderaNivel)
    {  
        super(1280, 720, 1);
        this.n=n;
        this.banderaNivel=banderaNivel;
        numbers= generateRandomNumbers();
        numR1= numbers.get(0);
        numR2= numbers.get(1);
        numR3= numbers.get(2);
        setBackground("fondoNegro.jpg"); 
        door1 = new Door(this,numR1,n,banderaNivel);
        door2 = new Door(this, numR2,n,banderaNivel);
        door3 = new Door(this,numR3,n,banderaNivel);
        
       
        
        
    }
   
    public void act()
    {
       if(time == false){
            fedIn = new Fed();
            addObject(fedIn ,getWidth()/2 , getHeight()/2);
            fedIn.fedInAnim();
            removeObject(fedIn);
            addObject(door1, getWidth()-1065 , getHeight()-305);
            addObject(door2, getWidth()-640 , getHeight()-305);
            addObject(door3, getWidth()-212 , getHeight()-305);
            if(n==2){
            c1=new Corazon();
            c2=new Corazon();
            addObject(c1, 275 , 70 );
            addObject(c2, 350 , 70 );
        }else if(n==1){
            c1=new Corazon();
            addObject(c1, 275 , 70 );
        }else if(n==3){
            c1=new Corazon();
            c2=new Corazon();
            c3=new Corazon(); 
            addObject(c3, 425 , 70 ); 
            addObject(c2, 350 , 70 );
            addObject(c1, 275 , 70 );
        }
            time=true;
        }
    }
   public List<Integer> generateRandomNumbers() {
  //  List<Integer> numbers = new ArrayList<>();

    // Generar tres n√∫meros aleatorios
    for (int i = 0; i < 3; i++) {
        int number;
        do {
            number = Greenfoot.getRandomNumber(3) + 1;
        } while (numbers.contains(number));
        numbers.add(number);
    }

    return numbers;
}

    public void apareceFantasma() {
        jumpscare = new GreenfootSound("sounds/jumps.mp3");
        jumpscare.play();
        phantom = new Phantom(label, timer,n,banderaNivel);
        addObject(phantom, getWidth() / 2, getHeight() / 2 + 50);
        addObject(timer, getWidth()-500, getHeight() / 10);
        addObject(label, getWidth()-200, getHeight() / 10);
        CircleCollider collider = new CircleCollider(15);
        addObject(yc, getWidth()/2 , getHeight()/2 );
        addObject(collider, getWidth() / 2, getHeight() / 2);
        removeObject(door1);
       // removeObject(door2);
        removeObject(door3);
        
    }
    
    public void desapareceFantasma() {
         if (label.act2() == 0) {
        removeObject(phantom);
        }
    }
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class Fin here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Fin extends World
{

    private GreenfootImage[] fin = new GreenfootImage[15];
    private int currentBackgroundIndex = 0;
    //private GreenfootSound amb;
    private int z,n;
    private Fed fedIn;
    private boolean time = false;
    public Fin()
    {    
        // Create a new world with 600x400 cells with a cell size of 1x1 pixels.
        super(1280, 720, 1);
        //this.n=n;
        initBackgrounds();
        //setBackground(fin[currentBackgroundIndex]);
        //amb = new GreenfootSound("sounds/amb.mp3");
        //amb.playLoop();
    }
     public void act()
    {
        if(time == false){
            currentBackgroundIndex = (currentBackgroundIndex + 1) % fin.length;
            setBackground(fin[currentBackgroundIndex]);
            clearPreviousBackground();
            fedIn = new Fed();
            addObject(fedIn ,getWidth()/2 , getHeight()/2);
            fedIn.fedInAnim();
            removeObject(fedIn);
            
            time=true;
        }
        checkKeyPressBck();
        
    }

    public void checkKeyPressBck()
    {
        if (Greenfoot.isKeyDown("w"))
        {
            Greenfoot.delay(5);
            currentBackgroundIndex = (currentBackgroundIndex + 1) % fin.length;
            setBackground(fin[currentBackgroundIndex]);
            clearPreviousBackground();
            z++;
            if(z>14){
                // amb.stop();
                 Greenfoot.setWorld(new GameOver());                
            }
        }
    }

    public void initBackgrounds() {
    int index = 20;
    for (int i = 0; i < 15; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "fin" + formattedIndex + ".jpg";
        fin[i] = new GreenfootImage(filename);
        index += 19; 
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + fin.length) % fin.length;
        fin[previousIndex].clear();
    }
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class GameOver here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class GameOver extends World
{
     private GreenfootImage[] gOver = new GreenfootImage[23];
    private int currentBackgroundIndex = 0;
    //private GreenfootSound amb;
    int n;
    
    public GameOver()
    {    
        // Create a new world with 600x400 cells with a cell size of 1x1 pixels.
        super(1280, 720, 1);
       
        initBackgrounds();
        setBackground(gOver[currentBackgroundIndex]);
       // amb = new GreenfootSound("sounds/amb.mp3");
        //amb.stop();
    }
     public void act()
    {
        checkKeyPressBck();
       
        
    }

    public void checkKeyPressBck()
    {
            currentBackgroundIndex = (currentBackgroundIndex + 1) % gOver.length;
            setBackground(gOver[currentBackgroundIndex]);
            clearPreviousBackground();
             if(currentBackgroundIndex==22){
                 //amb.stop();
                 Greenfoot.stop();
             }
               
            
    }
  
    public void initBackgrounds() {
    int index = 100;
    for (int i = 0; i < 23; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "gOver" + formattedIndex + ".jpg";
        gOver[i] = new GreenfootImage(filename);
        index += 2; 
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + gOver.length) % gOver.length;
        gOver[previousIndex].clear();
    }
   
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class Inicio here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Inicio extends World
{
    private GreenfootImage[] inicio = new GreenfootImage[22];
    private int currentBackgroundIndex = 0;
    private GreenfootSound amb;
    private int z=0;
    boolean start = false;
    public Inicio()
    {    
        // Create a new world with 600x400 cells with a cell size of 1x1 pixels.
        super(1280, 720, 1);
        initBackgrounds();
        setBackground(inicio[currentBackgroundIndex]);
        //letrero = new Letrero();
        
       // int bottomY = getHeight() - letrero.getImage().getHeight()-25;
        //addObject(letrero, getWidth() / 2, bottomY);
        
        amb = new GreenfootSound("sounds/amb.mp3");
        //amb.playLoop();
        
    }
     public void act()
    {
        checkKeyPressBck();
        
    }
       
    
    public void checkKeyPressBck()
    {   
        
        if (Greenfoot.isKeyDown("space")){
            start = true;
            amb.play();
          //  removeObject(letrero);
        }
        if (start == true)
        {
           
            Greenfoot.delay(5);
            currentBackgroundIndex = (currentBackgroundIndex + 1) % inicio.length;
            setBackground(inicio[currentBackgroundIndex]);
            clearPreviousBackground();
            z++;
            if(z>20){
                amb.stop();
                Greenfoot.setWorld(new Backgro());
                
            }
        }
    }

    public void initBackgrounds() {
    int index = 1;
    for (int i = 0; i < 21; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "inicio" + formattedIndex + ".jpg";
        inicio[i] = new GreenfootImage(filename);
        index += 12; 
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + inicio.length) % inicio.length;
        inicio[previousIndex].clear();
    }
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class MyWorld here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class MyWorld extends World
{

    /**
     * Constructor for objects of class MyWorld.
     * 
     */
    public MyWorld()
    {    
        // Create a new world with 600x400 cells with a cell size of 1x1 pixels.
        super(600, 400, 1); 
    }
}
import greenfoot.*;
import java.util.ArrayDeque;
import java.util.Deque;
import java.awt.Rectangle;

public class Resplandor extends World
{
    private GreenfootImage[] resplandor = new GreenfootImage[24];
    private int currentBackgroundIndex = 0;
    private YellowCircle yc = new YellowCircle(70);
    private GreenfootSound amb;
    private int z;
    private Corazon c1, c2,c3;
    private int n,banderaNivel;
    private Fed fedIn;
    
    public Resplandor(int n, int banderaNivel)
    {    
        super(1280, 720, 1);
        this.n=n;
        this.banderaNivel=banderaNivel;
        if(n==2){
        c1=new Corazon();
        c2=new Corazon();
        addObject(c1, 275 , 70 );
        addObject(c2, 350 , 70 );
        }else if(n==1){
            c1=new Corazon();
            addObject(c1, 275 , 70 );
        }else if(n==3){
            c1=new Corazon();
            c2=new Corazon();
            c3=new Corazon();
            addObject(c3, 425 , 70 ); 
            addObject(c2, 350 , 70 );
            addObject(c1, 275 , 70 );
        }
          
        Principal principal = new Principal();
        addObject(principal, getWidth()-1000 , getHeight()-50);
        initBackgrounds();
        setBackground(resplandor[currentBackgroundIndex]);
        addObject(yc, getWidth()/2 , getHeight()/2 );
        amb = new GreenfootSound("sounds/amb.mp3");
        amb.playLoop();
    }
  
    public void act()
    {
        checkKeyPressBck();
   
    }

    public void checkKeyPressBck()
    {
        if (Greenfoot.isKeyDown("w"))
        {
            Greenfoot.delay(5);
            currentBackgroundIndex = (currentBackgroundIndex + 1) % resplandor.length;
            setBackground(resplandor[currentBackgroundIndex]);
            clearPreviousBackground();
            z++;
            if(z>19){
                amb.stop();
                fedIn = new Fed();
                addObject(fedIn ,getWidth()/2 , getHeight()/2);
                fedIn.fedOutAnim();
                Greenfoot.setWorld(new BlackWorld(n,banderaNivel));
            }
        }
    }

    public void initBackgrounds() {
    int index = 1;
    for (int i = 0; i < 24; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "resp" + formattedIndex + ".jpg";
        resplandor[i] = new GreenfootImage(filename);
        index += 18;  // Increment the index 
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + resplandor.length) % resplandor.length;
        resplandor[previousIndex].clear();
    }

  
}


import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class terCorredor here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class TerCorredor extends World
{
    private GreenfootImage[] terCorredor = new GreenfootImage[24];
    private int currentBackgroundIndex = 0;
    private GreenfootSound amb;
    private int z=0;
     private YellowCircle yc = new YellowCircle(70);
    private Corazon c1, c2,c3;
    private int n,banderaNivel;
    private Fed fedIn;
    public TerCorredor(int n, int banderaNivel)
    {    
        // Create a new world with 600x400 cells with a cell size of 1x1 pixels.
        super(1280, 720, 1);
        this.n=n;
        this.banderaNivel=banderaNivel;
        if(n==2){
        c1=new Corazon();
        c2=new Corazon();
        addObject(c1, 275 , 70 );
        addObject(c2, 350 , 70 );
        }else if(n==1){
            c1=new Corazon();
            addObject(c1, 275 , 70 );
        }else if(n==3){
            c1=new Corazon();
            c2=new Corazon();
            c3=new Corazon();
            addObject(c3, 425 , 70 ); 
            addObject(c2, 350 , 70 );
            addObject(c1, 275 , 70 );
        }
        
        initBackgrounds();
        setBackground(terCorredor[currentBackgroundIndex]);
        amb = new GreenfootSound("sounds/amb.mp3");
        amb.play();
        
    }
     public void act()
    {
        checkKeyPressBck();
        
    }

    public void checkKeyPressBck()
    {
        if (Greenfoot.isKeyDown("w"))
        {
            Greenfoot.delay(8);
            currentBackgroundIndex = (currentBackgroundIndex + 1) % terCorredor.length;
            setBackground(terCorredor[currentBackgroundIndex]);
            clearPreviousBackground();
            z++;
            if(z>23){
                amb.stop();
                fedIn = new Fed();
                addObject(fedIn ,getWidth()/2 , getHeight()/2);
                fedIn.fedOutAnim();
                Greenfoot.setWorld(new BlackWorld(n,banderaNivel ));
            }
        }
    }

    public void initBackgrounds() {
    int index = 1;
    for (int i = 0; i < 24; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "terCorredor" + formattedIndex + ".jpg";
        terCorredor[i] = new GreenfootImage(filename);
        index += 22; 
    }
    }
  
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + terCorredor.length) % terCorredor.length;
        terCorredor[previousIndex].clear();
    }
}
import greenfoot.*; 

public class CircleCollider extends Actor {
    private int radius; // Radio del colisionador

    public CircleCollider(int radius) {
        this.radius = radius;
        GreenfootImage image = new GreenfootImage(2 * radius, 2 * radius);
        image.setColor(Color.RED); // El color rojo es solo para visualizaci√≥n, puedes cambiarlo si lo deseas
        image.fillOval(0, 0, 2 * radius, 2 * radius);
        setImage(image);
        setTransparency(45);
    }
    public void act() {
        MouseInfo mouse = Greenfoot.getMouseInfo();
        if (mouse != null) {
            setLocation(mouse.getX(), mouse.getY());
        }
    }
    public void setTransparency(int alpha) {
        GreenfootImage image = getImage();
        image.setTransparency(alpha);
        setImage(image);
    }
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class Corazon here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Corazon extends Actor
{
    private int nCorazon;
    public Corazon(){
        
       
    } 
    
    public void act()
    {
        // Add your action code here.
    }
    public void removeVida(){
         getWorld().removeObject(this);
    }
    
}

import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class g here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Door extends Actor
{
    /**
     * Act - do whatever the g wants to do. This method is called whenever
     * the 'Act' or 'Run' button gets pressed in the environment.
     */
    private BlackWorld world;
    int destino;
    int n,banderaNivel;
    private GreenfootImage[] anima = new GreenfootImage[16];
    private int animCounter = 0;
    private Fed fedIn;
    private GreenfootSound answer;
    private boolean aparece =false;
    public Door (BlackWorld world,int destino, int n,int banderaNivel){
        this.world = world;
        this.destino = 3;
        this.n=n;
        this.banderaNivel=banderaNivel;
        setImage("doorClosed.jpg"); 
        initAnimationSprites();

    }
   public void act()
    {
      
        if (Greenfoot.mouseClicked(this)) {
        // Se ha hecho clic en la puerta
         //setImage("doorOpen.jpg"); // Cambiar la imagen a "doorOpen.jpg"
            if(destino==3){
                banderaNivel++;
                bandera();
                answer = new GreenfootSound("sounds/correct.mp3");
                answer.play();
                fedIn = new Fed();
                world.addObject(fedIn ,world.getWidth()/2 , world.getHeight()/2);
                fedIn.fedOutAnim();
                if(banderaNivel==2){
                    Greenfoot.setWorld(new Resplandor(n,banderaNivel));
                }else if(banderaNivel==3)
                    Greenfoot.setWorld(new TerCorredor(n,banderaNivel));
                else if(banderaNivel==4)
                    Greenfoot.setWorld(new Fin()); 
            }else if(destino==2){
                bandera();
                world.apareceFantasma();
                
            }else if(destino==1){
                bandera();
                answer = new GreenfootSound("sounds/incorrect.mp3");
                answer.play();
                Greenfoot.setWorld(new Backgro(n,1));
            }
        }
        
        
    }
    public void bandera(){
        if(aparece == false){
              openDoor();
              aparece=true;
             // return;
            }
    }
      public void initAnimationSprites() {
    int index = 1;
    for (int i = 0; i < 16; i++) {
        String formattedIndex = String.format("%04d", index);
        String filename = "anima" + formattedIndex + ".jpg";
        anima[i] = new GreenfootImage(filename);
        index += 12; 
        }
   
    }
  
    public void animateDoor(){   
        setImage(anima[animCounter % 16]);
        animCounter++;
        
    }
     public void openDoor() {
       
        for (int i = 0; i < 16; i++) {
            Greenfoot.delay(3);// Agregar un peque√±o retraso entre cada fotograma
            animateDoor();
           
        }
       
    }
    
}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class Fed here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Fed extends Actor
{
    /**
     * Act - do whatever the Fed wants to do. This method is called whenever
     * the 'Act' or 'Run' button gets pressed in the environment.
     */
    private GreenfootImage[] fed = new GreenfootImage[4];
    private int currentBackgroundIndex = 0;
    
    public Fed(){
        initFedIn();
    }
    public void act()
    {
        
        
    }
    public void fedInAnim(){
        
        setImage(fed[0]);
        Greenfoot.delay(25); 
        for(int i = 0;i<4;i++){
            /*
            Greenfoot.delay(10);    
            currentBackgroundIndex = (currentBackgroundIndex + 1) % fed.length;
            setImage(fed[currentBackgroundIndex]);
            clearPreviousBackground();
            */
            //jumpscare.play();
            Greenfoot.delay(9); 
            setImage(fed[i]);
        }     
    }
    public void fedOutAnim(){
        
        for(int i = 3;  i>0;i--){
            //jumpscare.play();
            Greenfoot.delay(5);    
            setImage(fed[i]);
        }     
    }
    public void clearPreviousBackground() {
        int previousIndex = (currentBackgroundIndex - 1 + fed.length) % fed.length;
        fed[previousIndex].clear();
    }
    public void initFedIn() {
        fed[0]=new GreenfootImage("fed1.png");
        fed[1]=new GreenfootImage("fed2.png");
        fed[2]=new GreenfootImage("fed3.png");
        fed[3]=new GreenfootImage("fed4.png");
    }
}
import greenfoot.*;    // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)

/**
 * Write a description of class Label here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
public class Label extends Actor
{
     private int delayR; 
    private int count;

    public Label() {
        count = 100;
       
        updateImage();
    }

    public void act() {
         
    }
      // count--;
       // updateImage();
       public int act2(){
         delayR=Greenfoot.getRandomNumber(3);
         count-=delayR;
         Greenfoot.delay(delayR);
          if(count > 0){
            updateImage();
          }else{
           count=0;
           updateImage();
          }// Cambio: se verifica si el temporizador a√∫n no ha terminado
           return count;
       }
      private void updateImage() {
        GreenfootImage image = new GreenfootImage("Vida: " + count, 25, Color.WHITE, Color.BLACK);
        setImage(image);
    }
    public int getCount() {
    return count;
    }

}
import greenfoot.*;  // (World, Actor, GreenfootImage, Greenfoot and MouseInfo)
import java.awt.Rectangle;
/**
 * Write a description of class Phantom here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */

public class Phantom extends Actor
{
    GreenfootImage[] idle = new GreenfootImage[12];
    GreenfootImage[] spawn = new GreenfootImage[12];
    
    private int velocidadMaxima = 5;
    private int velocidadActual = 0;
    private int aceleracion = 1;
    private int direccionX = 1;
    private int direccionY = 1;
    
    private int colisionadorSize = 1;
    private Rectangle colisionador;
    private int animIdleCounter = 0;
    private int animCounterSpawn = 0;
    private int delayCounter = 0;
    private int delayDuration = 10; // Duraci√≥n del retraso en act cycles
    private boolean beingTouched = false;
    private Label label;
    private Timer timer;
    private Corazon c1;
    private Corazon c2;
    private Corazon c3;
    private boolean aparece =false;
    private int n;
    private int banderaNivel;
    public Phantom (Label label, Timer timer, int n,int banderaNivel){
        this.label = label;
        this.timer=timer;
        this.n=n;
        this.banderaNivel=banderaNivel;
        colisionador = new Rectangle(colisionadorSize, colisionadorSize);
        initAnimationSpritesIdle();
        initAnimationSpritesSpawn();
     
      
    }
    public void act()
    {
         if(aparece == false){
          spawn();
          aparece=true;
          return;
        }
        mover();
        checkCollision();
        checkLabelCount();
        checkTimerCount();
        updateLabelPosition();
    }
    private void mover() {
        if (!beingTouched) {
        // Restablecer velocidad normal
        velocidadMaxima = 5*banderaNivel;
        aceleracion = 1*banderaNivel;
        }
        // Actualizar la velocidad actual seg√∫n la aceleraci√≥n
        velocidadActual += aceleracion;

        // Limitar la velocidad m√°xima
        if (velocidadActual > velocidadMaxima) {
            velocidadActual = velocidadMaxima;
        }

        // Actualizar la posici√≥n seg√∫n la velocidad actual y la direcci√≥n de movimiento
        int x = getX() + (direccionX * velocidadActual);
        int y = getY() + (direccionY * velocidadActual);

        // Verificar si el objeto est√° cerca de los l√≠mites de la pantalla
        World world = getWorld();
        int maxX = world.getWidth() - 1;
        int maxY = world.getHeight() - 1;

        if ((direccionX == 1 && direccionY == 1) && (x >= maxX || y >= maxY)) {
            // Cambiar la direcci√≥n hacia arriba o hacia la izquierda para evitar la esquina
            if (Greenfoot.getRandomNumber(2) == 0) {
                direccionX = -1;
            } else {
                direccionY = -1;
            }
        } else if ((direccionX == -1 && direccionY == 1) && (x <= 0 || y >= maxY)) {
            // Cambiar la direcci√≥n hacia arriba o hacia la derecha para evitar la esquina
            if (Greenfoot.getRandomNumber(2) == 0) {
                direccionX = 1;
            } else {
                direccionY = -1;
            }
        } else if ((direccionX == 1 && direccionY == -1) && (x >= maxX || y <= 0)) {
            // Cambiar la direcci√≥n hacia abajo o hacia la izquierda para evitar la esquina
            if (Greenfoot.getRandomNumber(2) == 0) {
                direccionX = -1;
            } else {
                direccionY = 1;
            }
        } else if ((direccionX == -1 && direccionY == -1) && (x <= 0 || y <= 0)) {
            // Cambiar la direcci√≥n hacia abajo o hacia la derecha para evitar la esquina
            if (Greenfoot.getRandomNumber(2) == 0) {
                direccionX = 1;
            } else {
                direccionY = 1;
            }
        }

        // Actualizar la posici√≥n del objeto

        setLocation(x, y);
        animateIdleWithDelay();
    }
    

    public void idle (){
        //animateidle();
        animateIdleWithDelay();
       // setLocation(getX(),getY());
       
    }
    public void initAnimationSpritesIdle() {
        int index = 13;
        for (int i = 0; i < 12; i++) {
            String formattedIndex = String.format("%04d", index);
            String filename = "idle" + formattedIndex + ".png";
            idle[i] = new GreenfootImage(filename);
            index += 1;
        }
        
    }
  
    public void animateIdleWithDelay() {
        if (delayCounter < delayDuration) {
            delayCounter++;
        } else {
            setImage(idle[animIdleCounter % 12]);
            animIdleCounter++;
            delayCounter = 0;
        }
       
    }
    
    
    
    public void initAnimationSpritesSpawn(){
        int index2 = 1;
        for (int i = 0; i < 12; i++) {
        String formattedIndex = String.format("%04d", index2);
            String filename = "Spawn" + formattedIndex + ".png";
            spawn[i] = new GreenfootImage(filename);
            index2 += 1;  // Increment the index by 2
        }
    }
    public void spawn() {
       
        for (int i = 0; i < 12; i++) {
            animateSpawn();
            Greenfoot.delay(5); // Agregar un peque√±o retraso entre cada fotograma
        }
       
    }
    public void animateSpawn(){
        if (animCounterSpawn == 7){
                Greenfoot.delay(15);
            }
        setImage(spawn[animCounterSpawn % 12]);
        animCounterSpawn++;
    }
    
    public void checkCollision() {
    CircleCollider collider = (CircleCollider) getOneIntersectingObject(CircleCollider.class);
    if (collider != null) {
        increaseSpeed();
        label.act2();
        beingTouched = true; // Est√° siendo tocado
    } else {
        beingTouched = false; // No est√° siendo tocado
    }
    }
   
    public void increaseSpeed() {
    velocidadMaxima += 2*banderaNivel; // Aumentar la velocidad m√°xima en 2 unidades
    aceleracion += 1*banderaNivel; // Aumentar la aceleraci√≥n en 1 unidad
    }
    
    public void checkLabelCount() { //VENCE PERSONAJE A FANTASMA
    if (label != null && label.getCount() == 0) {
        // El contador del Label lleg√≥ a 0, desaparecer el fantasma y el Label
         
        World world= getWorld();
        if (getWorld() != null) {
            world.removeObject(this);
            world.removeObject(label);
            world.removeObject(timer);
            banderaNivel++;
                if(banderaNivel==2){
                    Greenfoot.setWorld(new Resplandor(n,banderaNivel));
                }else if(banderaNivel==3){
                    Greenfoot.setWorld(new TerCorredor(n,banderaNivel));//modificar PASILLO3
                }else if(banderaNivel==4)
                    Greenfoot.setWorld(new Fin()); 
        }
      }
    }

       public void checkTimerCount() {//PIERDE PERSONAJE CON FANTASMA
    if (timer != null && timer.getTime() < 0) {
        n--;
        World world= getWorld();
        initAnimationSpritesSpawn();
        spawn();
         if(n==0){
          Greenfoot.setWorld(new GameOver());  
        }else
        Greenfoot.setWorld(new Backgro(n,banderaNivel));
      }
  
    }
    
    private void updateLabelPosition() {
    if (label != null && getWorld() != null) {
        int offsetX = 10; // Ajusta el desplazamiento horizontal de la etiqueta
        int offsetY = 10; // Ajusta el desplazamiento vertical de la etiqueta
        if (getWorld().getObjects(Phantom.class).contains(this)) {
            label.setLocation(getX() + offsetX, getY() + offsetY -120);
        }
    }
    }

    

}
import greenfoot.*;  
import java.util.ArrayList;

public class Principal extends Actor
{
    private boolean stepRigth = true;
 
    public Principal(){
    }
    public void act()
    {
        checkKeys();

    }
    public void checkKeys(){
        if(Greenfoot.isKeyDown("w")){
            Greenfoot.delay(5);
            moveForward();
        }
        //if(avtivePhatom==true)
        //world.desapareceFantasma();
    }
    public void moveForward(){
        animateFoward();
    }

    public void animateFoward(){
        if(stepRigth){
            setLocation(getX()-7,getY()-10);
            stepRigth=false;
        }else{
            setLocation(getX()+7,getY()+10);
            stepRigth=true;
        }
    }
}
/*import greenfoot.*;  

public class Timer extends Actor 
{
    private int timer=60 ; // about 60 seconds = 55 * 10
    private GreenfootImage[] walkForward = new GreenfootImage[5];
    private int animCounter = 0;
     //private int animationTimer = 55 * 2;
   
    
    public Timer()
    {
        //timer;
       // initAnimationSprites();
       // updateImage();
        //getTime();
    }

    public void act() {
      if (getTime()<11) { // Cambio: se verifica si el temporizador a√∫n no ha terminado
          //  if (timer % 12 == 0) {  
           // animateForward(); // Cambia la imagen utilizando el m√©todo animateForward()
            updateImage();
       // }
    //}    
            
        }
        //if (timer < 1) Greenfoot.stop();
        getTime();
       
    }
    public int getTime(){
        timer--;
        Greenfoot.delay(5);   
        return timer;
    }
      public void updateImage() {
        GreenfootImage image = new GreenfootImage("timer: " + timer, 30, Color.WHITE, Color.BLACK);
        setImage(image);
    }
    
     public void initAnimationSprites()
    {
        for (int i = 0; i < 5; i++) {
            String filename = "a" + (i + 1) + ".png";
            walkForward[i] = new GreenfootImage(filename);
        }
    }
    
    public void animateForward()
    {
        setImage(walkForward[animCounter % 5]);
        animCounter++;
      
    }
}*/

import greenfoot.*;  

public class Timer extends Actor 
{
    private int timer = 400; // aproximadamente 60 segundos = 55 * 10
    private GreenfootImage[] walkForward = new GreenfootImage[5];
    private int animCounter = 0;
    private int mod=timer/5;
    public Timer()
    {
        initAnimationSprites();
       // updateImage();
    }

    public void act() {
        timer--; 
        if (timer%mod==0) {
          //  updateImage();
            animateForward();
        }
        
        /*if (timer < 1) {
            Greenfoot.stop();
        }*/
    }
    
    public int getTime() {  
        return timer;
    }
    
    public void updateImage() {
        GreenfootImage image = new GreenfootImage("timer: " + timer/60, 30, Color.WHITE, Color.BLACK);
        setImage(image);
    }
    
    public void initAnimationSprites() {
        for (int i = 0; i < 5; i++) {
            String filename = "a" + (i + 1) + ".png";
            walkForward[i] = new GreenfootImage(filename);
        }
    }
    
    public void animateForward() {
        setImage(walkForward[animCounter % 5]);
        animCounter++;
    }
}
import greenfoot.*; 

public class YellowCircle extends Actor {
    private int radius; // Radio del c√≠rculo
    
    

    public YellowCircle(int radius) {
        this.radius = radius;
        GreenfootImage image = new GreenfootImage(2 * radius, 2 * radius);
        image.setColor(Color.YELLOW);
        image.fillOval(0, 0, 2 * radius, 2 * radius);
        setImage(image);
        setTransparency(50);
    }
    
    public void act() {
        MouseInfo mouse = Greenfoot.getMouseInfo();
        if (mouse != null) {
            setLocation(mouse.getX(), mouse.getY());
        }
    }
    public void setTransparency(int alpha) {
        GreenfootImage image = getImage();
        image.setTransparency(alpha);
        setImage(image);
    }

}
